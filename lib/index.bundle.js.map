{"version":3,"file":"index.bundle.js","sources":["../src/utils.js","../src/index.js"],"sourcesContent":["/* eslint no-param-reassign: 0 */\nexport const emptyFunc = () => {};\n\nexport const STATUS = {\n  UNFETCH: 0,\n  FETCHING: 1,\n  FETCHED: 2,\n  LOADING: 3,\n  LOADED: 4,\n  EXECUTED: 5,\n};\n\nexport const deepExtend = (target, source) => {\n  Object.keys(source).forEach((key) => {\n    if (typeof target[key] === 'object') {\n      deepExtend(target[key], source[key]);\n    } else {\n      target[key] = source[key];\n    }\n  });\n};\n\n/**\n * Test whether str starts with prefix. Use '/' to complete pathname.\n */\nexport const hasPrefix = (str, prefix) => (`${str}/`.indexOf(`${prefix}/`) === 0);\n\n/**\n * map to sorted list, transform an object to an sorted array. The sort rule examples:\n * { a: 1, b: 2, c: 3 } => [{ k: a, v: 1 }, { k: b, v: 2 } , { k: a, v: 3 }];\n * { '*': 'barv1.0', 'some/old': 'barv0.1', 'some/new': 'barv1.1' } =>\n *              [{ k: 'some/old',v: 'barv0.1' },{ k: 'some/new',v: 'barv1.1' },{ k: '*', v: 'barv1.0' }]\n * @param { Object } obj, the object to transform\n * @returns { Array }\n */\nexport const mapToSortedList = (obj) => {\n  const list = [];\n  Object.keys(obj).forEach((key) => {\n    list.push({ k: key, v: obj[key] });\n  });\n  list.sort((a, b) => {\n    if (b.k === '*') {\n      return -1;\n    }\n    if (a.k === '*') {\n      return 1;\n    }\n    return b.k.length - a.k.length;\n  });\n  return list;\n};\n\n/**\n * Get dirname of uri. Examples:\n * file:///Users/henry/a/b/c => file:///Users/henry/a/b \n * https://www.google.com/a/b/c#/a/b/c/?q=s => https://www.google.com/a/b\n * @param { String } uri\n * @returns { String } the relative dirname\n */\nexport const dirName = (uri) => {\n  const dir = uri.match(/([^?#]*)(\\/[^$])/);\n  return (dir && dir[1]) || '';\n};\n\n/**\n * Get relative uri by base. Relative module ID resolution examples:\n * ( uri: ../d, base: a/b/c ) => a/d\n * ( uri: ./e, base: a/b/c ) => a/b/e\n * @param { String } uri, input uri\n * @param { String } base, base uri\n * @returns { String } target uri \n */\nexport const relativeUri = (uri, base) => {\n  const segments = base.split('/').concat(uri.split('/'));\n  const path = [];\n  segments.forEach((seg) => {\n    if (!seg || seg === '.') {\n      return;\n    }\n    if (seg === '..') {\n      path.pop();\n    } else {\n      path.push(seg);\n    }\n  });\n  return path.join('/');\n};\n\n/**\n * Conditional iterate, breaks when iterator(item, idx) === false\n * @param { Array } arr to iterate\n * @param { Function } iterator of each array element, iterator(item, idx)\n * @returns { Undefined } returns nothing\n */\nexport const conditionalIterate = (arr, iterator) => {\n  if (Array.isArray(arr)) {\n    for (let i = 0; i < arr.length; i += 1) {\n      if (iterator(arr[i], i) === false) {\n        break;\n      }\n    }\n  }\n};\n\n/**\n * If a module is a builtin module return false, otherwise, return true \n * @param { String } module id\n * @returns { Boolean } whether a module is a builtin module\n */\nexport const isBuiltInModule = (id) => {\n  const builtinModule = {\n    require: true,\n    exports: true,\n    module: true,\n  };\n  return !!builtinModule[id];\n};\n","/* eslint no-plusplus: 0, no-use-before-define: 0, no-param-reassign: 0 */\nimport global from 'global';\nimport { conditionalIterate, mapToSortedList, dirName, relativeUri, deepExtend,\n  emptyFunc, STATUS, isBuiltInModule, hasPrefix } from './utils';\n\nconst cachedModules = {}; // cache loaded modules\nconst cwd = dirName(location.pathname); // Current working directory, the relative dir name.\n\nlet currentlyAddingScript = null;\nlet interactiveScript = null;\nconst headElement = document.getElementsByTagName('head')[0];\n\nlet uid = 0; // Unique id to idenity loaded modules.\nconst getUid = () => `./async_${uid++}`;\n\nconst config = {\n  baseUrl: cwd,\n  paths: [],\n  map: {},\n  packages: [],\n  pathList: [],\n  mapList: [],\n  shim: {},\n};\n\nclass Module {\n  constructor(id) {\n    this.id = id;\n    this.uri = id2Uri(id);\n    this.deps = [];\n    this.depsDec = true;\n    this.state = STATUS.UNFETCH;\n    this.factory = emptyFunc;\n    this.exports = {};\n\n    this.require = requireFactory(getUid());\n    this.require.toUrl = (iid) => {\n      const absId = resolveId(iid);\n      return id2Uri(absId);\n    };\n\n    this.loadListeners = []; // Invoke these listeners to inform the dependent modules to handle dependencies when module loaded.  \n  }\n\n  loadModule() {\n    if (this.state === STATUS.FETCHING) {\n      return;\n    }\n    if (this.state <= STATUS.UNFETCH) {\n      this.fetchModule();\n      return;\n    }\n\n    this.state = STATUS.LOADING;\n    const deps = this.deps || [];\n    this.remain = deps.length;\n\n    const onDependencyLoaded = () => {\n      this.remain -= 1;\n      if (this.remain === 0) {\n        this.onModuleLoaded();\n      }\n    };\n\n    deps.forEach((dep) => {\n      if (isBuiltInModule(dep)) {\n        this.remain -= 1;\n        return;\n      }\n\n      if (dep.indexOf('!') > -1) {\n        this.loadPlugin(dep, onDependencyLoaded);\n        return;\n      }\n\n      const absId = resolveId(dep, this.id);\n      const m = getModule(absId);\n      if (m.state >= STATUS.LOADED || (m.state === STATUS.LOADING && !this.isForce)) {\n        // equal situation is for circle dependency\n        this.remain -= 1;\n        return;\n      }\n      m.loadListeners.push(onDependencyLoaded);\n      if (m.state < STATUS.LOADING) {\n        m.loadModule();\n      }\n    });\n\n    if (this.remain === 0) {\n      this.onModuleLoaded();\n    }\n  }\n\n  onModuleLoaded() {\n    if (this.state >= STATUS.LOADED) {\n      return;\n    }\n\n    this.state = STATUS.LOADED;\n    this.loadListeners.forEach((listener) => {\n      listener();\n    });\n\n    if (typeof this.callback === 'function') {\n      this.callback();\n    }\n  }\n\n  fetchModule() {\n    this.state = STATUS.FETCHING;\n    const onModuleFetched = () => {\n      const readyState = script.readyState;\n      if (readyState === undefined || /^(loaded || complete)$/.test(readyState)) {\n        this.state = STATUS.FETCHED;\n        this.loadModule();\n        interactiveScript = null;\n      }\n    };\n    const script = document.createElement('script');\n    script.src = `${this.uri}.js`;\n    script.setAttribute('data-module-id', this.id);\n    script.async = true;\n    if (script.readyState) {\n      script.onreadystatechange = onModuleFetched;\n    } else {\n      script.onload = onModuleFetched;\n    }\n\n    // append script\n    currentlyAddingScript = script;\n    headElement.appendChild(script);\n    currentlyAddingScript = null;\n  }\n\n  executeModule() {\n    if (this.state >= STATUS.EXECUTED) {\n      return this.exports;\n    }\n    const dependencies = this.getDependencyExports();\n    if (typeof this.factory === 'function') {\n      const res = this.factory.apply(null, dependencies);\n      this.exports = res || this.exports;\n    } else {\n      this.exports = this.factory;\n    }\n    this.state = STATUS.EXECUTED;\n    return this.exports;\n  }\n\n  // get module dependencies\n  getDependencyExports() {\n    if (this.state < STATUS.LOADED) {\n      throw new Error('Get dependencies export before loaded.');\n    }\n\n    let exports = [];\n    if (!this.depsDec) {\n      exports = [this.require, this.exports, this];\n    } else {\n      const deps = this.deps || [];\n      const argsLen = this.factory.length < deps.length ? this.factory.length : deps.length;\n      for (let i = 0; i < argsLen; i++) {\n        switch (deps[i]) {\n          case 'require':\n            exports.push(this.require);\n            break;\n          case 'exports':\n            exports.push(this.exports);\n            break;\n          case 'module':\n            exports.push(this);\n            break;\n          default:\n            exports.push(this.require(deps[i]));\n        }\n      }\n    }\n    return exports;\n  }\n}\n/**\n * Resolve module id\n * @param { String } id, the id of module\n * @param { String } base, the base uri of the module for resolving id\n * @returns { String } return the resolved id\n */\nconst resolveId = (id, base) => {\n  id = packagedId(id);\n  id = mappedId(id, base);\n\n  if (id.indexOf('.') === 0) {\n    id = relativeUri(id, dirName(base));\n  }\n\n  id = packagedId(id);\n  return id;\n};\n\n/**\n * To support package config: http://requirejs.org/docs/api.html#packages\n * @param { String } id\n * @returns { String } packaged id\n */\nconst packagedId = (id) => {\n  conditionalIterate(config.packages, (pkg) => {\n    if (pkg.name === id) {\n      id = `${pkg.name}/${(pkg.main || 'main')}`;\n    }\n    return false;\n  });\n  return id;\n};\n\n/**\n * To support map config: http://requirejs.org/docs/api.html#config-map\n * @param { String } id, the module id\n * @param { String } base, the base url of the id\n * @returns { String } the mapped id.\n */\nconst mappedId = (id, base) => {\n  conditionalIterate(config.mapList, (item) => {\n    if (hasPrefix(base, item.k) || item.k === '*') {\n      conditionalIterate(item.v, (map) => {\n        if (hasPrefix(id, map.k)) {\n          id = id.replace(map.k, map.v);\n          return false;\n        }\n        return true;\n      });\n      return false;\n    }\n    return true;\n  });\n  return id;\n};\n\n/**\n * Get the module url of specified module id. \n * @param { String } The resolved id of the module.\n * @returns { String } The loading path of the module.\n */\nconst id2Uri = (id) => {\n  config.pathList.forEach((pathMap) => {\n    if (hasPrefix(id, pathMap.k)) {\n      id = id.replace(pathMap.k, pathMap.v);\n    }\n  });\n\n  // absolute path\n  if (id.charAt('0') === '/' || id.indexOf('http') === '0') {\n    return id;\n  }\n  return `/${relativeUri(id, config.baseUrl || cwd)}`;\n};\n\n/**\n * If cached, return cached module, otherwise, return a new module. \n * @param { String } id, module id\n * @returns { Module } return the corresponding module\n */\nconst getModule = (id) => {\n  const mod = cachedModules[id];\n  if (mod) {\n    return mod;\n  }\n  cachedModules[id] = new Module(id);\n  return cachedModules[id];\n};\n\nconst getCurrentScript = () => {\n  if (document.currentScript) {\n    return document.currentScript;\n  }\n\n  if (currentlyAddingScript) {\n    return currentlyAddingScript;\n  }\n\n  if (interactiveScript && interactiveScript.readyState === 'interactive') {\n    return interactiveScript;\n  }\n\n  const scritps = document.getElementsByTagName('script');\n  scritps.forEach((script) => {\n    if (script.readyState === 'interactive') {\n      interactiveScript = script;\n    }\n  });\n\n  return interactiveScript;\n};\n\n/**\n * define function, for detail: https://github.com/amdjs/amdjs-api/blob/master/AMD.md#define-function-\n * @param { String } module id to define, optional\n * @param { Array } deps, dependent modules of this module\n * @param { Function or Object } factory function of the module\n * @returns { Undefined } returns nothing\n */\nconst define = (id, deps, factory) => {\n  if (deps === undefined && factory === undefined) {\n    // define(factory)\n    factory = id;\n    id = null;\n  } else if (factory === undefined) {\n    // define(id, factory);\n    // define(deps, factory);\n    factory = deps;\n    deps = null;\n    if (Array.isArray(id)) {\n      deps = id;\n      id = null;\n    }\n  }\n\n  let depsDec = true;\n  if (!Array.isArray(deps) && typeof factory === 'function') {\n    deps = [];\n    factory.toString()\n      .replace(/(\\/\\*([\\s\\S]*?)\\*\\/|([^:]|^)\\/\\/(.*)$)/mg, '')\n      .replace(/[^.]\\s*require\\s*\\(\\s*[\"']([^'\"\\s]+)[\"']\\s*\\)/g, (match, dep) => {\n        deps.push(dep);\n      });\n    depsDec = false;\n  }\n\n  if (!id) {\n    const script = getCurrentScript();\n    id = script && script.getAttribute('data-module-id');\n  }\n\n  if (!id) {\n    return;\n  }\n\n  const mod = getModule(id);\n  mod.id = id;\n  mod.deps = deps || [];\n  mod.depsDec = depsDec;\n  mod.factory = factory;\n  mod.state = STATUS.FETCHED;\n};\ndefine.amd = {};\n\n/**\n * require function factory\n * @param { String }, base id\n * @returns { Function }, require function: https://github.com/amdjs/amdjs-api/blob/master/require.md\n */\nconst requireFactory = base => (deps, callback, isForce) => {\n  if (!Array.isArray(deps)) {\n    // require('a') or require('a!./b')\n    const id = resolveId(deps, base);\n    return getModule(id).executeModule();\n  }\n  const randomId = resolveId(getUid(), base);\n  const mod = new Module(randomId);\n  mod.deps = deps;\n  mod.factory = callback || emptyFunc;\n  mod.callback = () => {\n    mod.deps.forEach((dep) => {\n      if (dep.indexOf('!') === -1 && !isBuiltInModule(dep)) {\n        mod.require(dep);\n      }\n    });\n    mod.executeModule();\n  };\n  mod.state = STATUS.FETCHED;\n  mod.isForce = isForce;\n  mod.loadModule();\n  return mod;\n};\n\n// require function implementation: https://github.com/amdjs/amdjs-api/blob/master/require.md\nconst require = requireFactory(getUid());\nrequire.config = (obj) => {\n  deepExtend(config, obj);\n  if (obj.baseUrl) {\n    if (obj.baseUrl.charAt(0) === '.') {\n      config.baseUrl = relativeUri(obj.baseUrl, cwd);\n    } else {\n      config.baseUrl = obj.baseUrl;\n    }\n  }\n\n  config.packages.forEach((packageConf, idx) => {\n    if (typeof packageConf === 'string') {\n      const segments = packageConf.split('/');\n      config.packages[idx] = {\n        name: segments[0],\n        location: packageConf,\n        main: 'main',\n      };\n    }\n\n    if (packageConf.main) {\n      packageConf.main = packageConf.main.replace('.js', '');\n    }\n\n    if (packageConf.location) {\n      config.paths[packageConf.name] = packageConf.location;\n    }\n  });\n\n  config.mapList = mapToSortedList(config.map);\n  config.mapList.forEach((item) => {\n    item.v = mapToSortedList(item.v);\n  });\n\n  config.pathList = mapToSortedList(config.paths);\n};\n\nif (!global.require) {\n  global.require = require;\n  global.define = define;\n  global.cachedModules = cachedModules;\n}\n\nexport default {\n  cachedModules,\n  require,\n  define,\n};\n"],"names":["emptyFunc","STATUS","deepExtend","target","source","keys","forEach","key","hasPrefix","str","prefix","indexOf","mapToSortedList","obj","list","push","k","v","sort","a","b","length","dirName","uri","dir","match","relativeUri","base","segments","split","concat","path","seg","pop","join","conditionalIterate","arr","iterator","Array","isArray","i","isBuiltInModule","id","builtinModule","cachedModules","cwd","location","pathname","currentlyAddingScript","interactiveScript","headElement","document","getElementsByTagName","uid","getUid","config","Module","id2Uri","deps","depsDec","state","UNFETCH","factory","exports","require","requireFactory","toUrl","iid","absId","resolveId","loadListeners","FETCHING","fetchModule","LOADING","remain","onDependencyLoaded","onModuleLoaded","dep","loadPlugin","m","getModule","LOADED","isForce","loadModule","listener","callback","onModuleFetched","readyState","script","undefined","test","FETCHED","createElement","src","setAttribute","async","onreadystatechange","onload","appendChild","EXECUTED","dependencies","getDependencyExports","res","apply","Error","argsLen","packagedId","mappedId","packages","pkg","name","main","mapList","item","map","replace","pathList","pathMap","charAt","baseUrl","mod","getCurrentScript","currentScript","scritps","define","toString","getAttribute","amd","executeModule","randomId","packageConf","idx","paths","global"],"mappings":";;;;;AAAA;AACA,AAAO,MAAMA,YAAY,MAAM,EAAxB;;AAEP,AAAO,MAAMC,SAAS;WACX,CADW;YAEV,CAFU;WAGX,CAHW;WAIX,CAJW;UAKZ,CALY;YAMV;CANL;;AASP,AAAO,MAAMC,aAAa,CAACC,MAAD,EAASC,MAAT,KAAoB;SACrCC,IAAP,CAAYD,MAAZ,EAAoBE,OAApB,CAA6BC,GAAD,IAAS;QAC/B,OAAOJ,OAAOI,GAAP,CAAP,KAAuB,QAA3B,EAAqC;iBACxBJ,OAAOI,GAAP,CAAX,EAAwBH,OAAOG,GAAP,CAAxB;KADF,MAEO;aACEA,GAAP,IAAcH,OAAOG,GAAP,CAAd;;GAJJ;CADK;;;;;AAaP,AAAO,MAAMC,YAAY,CAACC,GAAD,EAAMC,MAAN,KAAmB,GAAED,GAAI,GAAP,CAAUE,OAAV,CAAmB,GAAED,MAAO,GAA5B,MAAoC,CAAxE;;;;;;;;;;AAUP,AAAO,MAAME,kBAAmBC,GAAD,IAAS;QAChCC,OAAO,EAAb;SACOT,IAAP,CAAYQ,GAAZ,EAAiBP,OAAjB,CAA0BC,GAAD,IAAS;SAC3BQ,IAAL,CAAU,EAAEC,GAAGT,GAAL,EAAUU,GAAGJ,IAAIN,GAAJ,CAAb,EAAV;GADF;OAGKW,IAAL,CAAU,CAACC,CAAD,EAAIC,CAAJ,KAAU;QACdA,EAAEJ,CAAF,KAAQ,GAAZ,EAAiB;aACR,CAAC,CAAR;;QAEEG,EAAEH,CAAF,KAAQ,GAAZ,EAAiB;aACR,CAAP;;WAEKI,EAAEJ,CAAF,CAAIK,MAAJ,GAAaF,EAAEH,CAAF,CAAIK,MAAxB;GAPF;SASOP,IAAP;CAdK;;;;;;;;;AAwBP,AAAO,MAAMQ,UAAWC,GAAD,IAAS;QACxBC,MAAMD,IAAIE,KAAJ,CAAU,kBAAV,CAAZ;SACQD,OAAOA,IAAI,CAAJ,CAAR,IAAmB,EAA1B;CAFK;;;;;;;;;;AAaP,AAAO,MAAME,cAAc,CAACH,GAAD,EAAMI,IAAN,KAAe;QAClCC,WAAWD,KAAKE,KAAL,CAAW,GAAX,EAAgBC,MAAhB,CAAuBP,IAAIM,KAAJ,CAAU,GAAV,CAAvB,CAAjB;QACME,OAAO,EAAb;WACSzB,OAAT,CAAkB0B,GAAD,IAAS;QACpB,CAACA,GAAD,IAAQA,QAAQ,GAApB,EAAyB;;;QAGrBA,QAAQ,IAAZ,EAAkB;WACXC,GAAL;KADF,MAEO;WACAlB,IAAL,CAAUiB,GAAV;;GAPJ;SAUOD,KAAKG,IAAL,CAAU,GAAV,CAAP;CAbK;;;;;;;;AAsBP,AAAO,MAAMC,qBAAqB,CAACC,GAAD,EAAMC,QAAN,KAAmB;MAC/CC,MAAMC,OAAN,CAAcH,GAAd,CAAJ,EAAwB;SACjB,IAAII,IAAI,CAAb,EAAgBA,IAAIJ,IAAIf,MAAxB,EAAgCmB,KAAK,CAArC,EAAwC;UAClCH,SAASD,IAAII,CAAJ,CAAT,EAAiBA,CAAjB,MAAwB,KAA5B,EAAmC;;;;;CAHlC;;;;;;;AAeP,AAAO,MAAMC,kBAAmBC,EAAD,IAAQ;QAC/BC,gBAAgB;aACX,IADW;aAEX,IAFW;YAGZ;GAHV;SAKO,CAAC,CAACA,cAAcD,EAAd,CAAT;CANK;;AC7GP;AACA,AAIA,MAAME,gBAAgB,EAAtB;AACA,MAAMC,MAAMvB,QAAQwB,SAASC,QAAjB,CAAZ;;AAEA,IAAIC,wBAAwB,IAA5B;AACA,IAAIC,oBAAoB,IAAxB;AACA,MAAMC,cAAcC,SAASC,oBAAT,CAA8B,MAA9B,EAAsC,CAAtC,CAApB;;AAEA,IAAIC,MAAM,CAAV;AACA,MAAMC,SAAS,MAAO,WAAUD,KAAM,EAAtC;;AAEA,MAAME,SAAS;WACJV,GADI;SAEN,EAFM;OAGR,EAHQ;YAIH,EAJG;YAKH,EALG;WAMJ,EANI;QAOP;CAPR;;AAUA,MAAMW,MAAN,CAAa;cACCd,EAAZ,EAAgB;SACTA,EAAL,GAAUA,EAAV;SACKnB,GAAL,GAAWkC,OAAOf,EAAP,CAAX;SACKgB,IAAL,GAAY,EAAZ;SACKC,OAAL,GAAe,IAAf;SACKC,KAAL,GAAa3D,OAAO4D,OAApB;SACKC,OAAL,GAAe9D,SAAf;SACK+D,OAAL,GAAe,EAAf;;SAEKC,OAAL,GAAeC,eAAeX,QAAf,CAAf;SACKU,OAAL,CAAaE,KAAb,GAAsBC,GAAD,IAAS;YACtBC,QAAQC,UAAUF,GAAV,CAAd;aACOV,OAAOW,KAAP,CAAP;KAFF;;SAKKE,aAAL,GAAqB,EAArB,CAfc;;;eAkBH;QACP,KAAKV,KAAL,KAAe3D,OAAOsE,QAA1B,EAAoC;;;QAGhC,KAAKX,KAAL,IAAc3D,OAAO4D,OAAzB,EAAkC;WAC3BW,WAAL;;;;SAIGZ,KAAL,GAAa3D,OAAOwE,OAApB;UACMf,OAAO,KAAKA,IAAL,IAAa,EAA1B;SACKgB,MAAL,GAAchB,KAAKrC,MAAnB;;UAEMsD,qBAAqB,MAAM;WAC1BD,MAAL,IAAe,CAAf;UACI,KAAKA,MAAL,KAAgB,CAApB,EAAuB;aAChBE,cAAL;;KAHJ;;SAOKtE,OAAL,CAAcuE,GAAD,IAAS;UAChBpC,gBAAgBoC,GAAhB,CAAJ,EAA0B;aACnBH,MAAL,IAAe,CAAf;;;;UAIEG,IAAIlE,OAAJ,CAAY,GAAZ,IAAmB,CAAC,CAAxB,EAA2B;aACpBmE,UAAL,CAAgBD,GAAhB,EAAqBF,kBAArB;;;;YAIIP,QAAQC,UAAUQ,GAAV,EAAe,KAAKnC,EAApB,CAAd;YACMqC,IAAIC,UAAUZ,KAAV,CAAV;UACIW,EAAEnB,KAAF,IAAW3D,OAAOgF,MAAlB,IAA6BF,EAAEnB,KAAF,KAAY3D,OAAOwE,OAAnB,IAA8B,CAAC,KAAKS,OAArE,EAA+E;;aAExER,MAAL,IAAe,CAAf;;;QAGAJ,aAAF,CAAgBvD,IAAhB,CAAqB4D,kBAArB;UACII,EAAEnB,KAAF,GAAU3D,OAAOwE,OAArB,EAA8B;UAC1BU,UAAF;;KApBJ;;QAwBI,KAAKT,MAAL,KAAgB,CAApB,EAAuB;WAChBE,cAAL;;;;mBAIa;QACX,KAAKhB,KAAL,IAAc3D,OAAOgF,MAAzB,EAAiC;;;;SAI5BrB,KAAL,GAAa3D,OAAOgF,MAApB;SACKX,aAAL,CAAmBhE,OAAnB,CAA4B8E,QAAD,IAAc;;KAAzC;;QAII,OAAO,KAAKC,QAAZ,KAAyB,UAA7B,EAAyC;WAClCA,QAAL;;;;gBAIU;SACPzB,KAAL,GAAa3D,OAAOsE,QAApB;UACMe,kBAAkB,MAAM;YACtBC,aAAaC,OAAOD,UAA1B;UACIA,eAAeE,SAAf,IAA4B,yBAAyBC,IAAzB,CAA8BH,UAA9B,CAAhC,EAA2E;aACpE3B,KAAL,GAAa3D,OAAO0F,OAApB;aACKR,UAAL;4BACoB,IAApB;;KALJ;UAQMK,SAASrC,SAASyC,aAAT,CAAuB,QAAvB,CAAf;WACOC,GAAP,GAAc,GAAE,KAAKtE,GAAI,KAAzB;WACOuE,YAAP,CAAoB,gBAApB,EAAsC,KAAKpD,EAA3C;WACOqD,KAAP,GAAe,IAAf;QACIP,OAAOD,UAAX,EAAuB;aACdS,kBAAP,GAA4BV,eAA5B;KADF,MAEO;aACEW,MAAP,GAAgBX,eAAhB;;;;4BAIsBE,MAAxB;gBACYU,WAAZ,CAAwBV,MAAxB;4BACwB,IAAxB;;;kBAGc;QACV,KAAK5B,KAAL,IAAc3D,OAAOkG,QAAzB,EAAmC;aAC1B,KAAKpC,OAAZ;;UAEIqC,eAAe,KAAKC,oBAAL,EAArB;QACI,OAAO,KAAKvC,OAAZ,KAAwB,UAA5B,EAAwC;YAChCwC,MAAM,KAAKxC,OAAL,CAAayC,KAAb,CAAmB,IAAnB,EAAyBH,YAAzB,CAAZ;WACKrC,OAAL,GAAeuC,OAAO,KAAKvC,OAA3B;KAFF,MAGO;WACAA,OAAL,GAAe,KAAKD,OAApB;;SAEGF,KAAL,GAAa3D,OAAOkG,QAApB;WACO,KAAKpC,OAAZ;;;;yBAIqB;QACjB,KAAKH,KAAL,GAAa3D,OAAOgF,MAAxB,EAAgC;YACxB,IAAIuB,KAAJ,CAAU,wCAAV,CAAN;;;QAGEzC,UAAU,EAAd;QACI,CAAC,KAAKJ,OAAV,EAAmB;gBACP,CAAC,KAAKK,OAAN,EAAe,KAAKD,OAApB,EAA6B,IAA7B,CAAV;KADF,MAEO;YACCL,OAAO,KAAKA,IAAL,IAAa,EAA1B;YACM+C,UAAU,KAAK3C,OAAL,CAAazC,MAAb,GAAsBqC,KAAKrC,MAA3B,GAAoC,KAAKyC,OAAL,CAAazC,MAAjD,GAA0DqC,KAAKrC,MAA/E;WACK,IAAImB,IAAI,CAAb,EAAgBA,IAAIiE,OAApB,EAA6BjE,GAA7B,EAAkC;gBACxBkB,KAAKlB,CAAL,CAAR;eACO,SAAL;oBACUzB,IAAR,CAAa,KAAKiD,OAAlB;;eAEG,SAAL;oBACUjD,IAAR,CAAa,KAAKgD,OAAlB;;eAEG,QAAL;oBACUhD,IAAR,CAAa,IAAb;;;oBAGQA,IAAR,CAAa,KAAKiD,OAAL,CAAaN,KAAKlB,CAAL,CAAb,CAAb;;;;WAIDuB,OAAP;;;;;;;;;AASJ,MAAMM,YAAY,CAAC3B,EAAD,EAAKf,IAAL,KAAc;OACzB+E,WAAWhE,EAAX,CAAL;OACKiE,SAASjE,EAAT,EAAaf,IAAb,CAAL;;MAEIe,GAAG/B,OAAH,CAAW,GAAX,MAAoB,CAAxB,EAA2B;SACpBe,YAAYgB,EAAZ,EAAgBpB,QAAQK,IAAR,CAAhB,CAAL;;;OAGG+E,WAAWhE,EAAX,CAAL;SACOA,EAAP;CATF;;;;;;;AAiBA,MAAMgE,aAAchE,EAAD,IAAQ;qBACNa,OAAOqD,QAA1B,EAAqCC,GAAD,IAAS;QACvCA,IAAIC,IAAJ,KAAapE,EAAjB,EAAqB;WACb,GAAEmE,IAAIC,IAAK,IAAID,IAAIE,IAAJ,IAAY,MAAQ,EAAzC;;WAEK,KAAP;GAJF;SAMOrE,EAAP;CAPF;;;;;;;;AAgBA,MAAMiE,WAAW,CAACjE,EAAD,EAAKf,IAAL,KAAc;qBACV4B,OAAOyD,OAA1B,EAAoCC,IAAD,IAAU;QACvCzG,UAAUmB,IAAV,EAAgBsF,KAAKjG,CAArB,KAA2BiG,KAAKjG,CAAL,KAAW,GAA1C,EAA+C;yBAC1BiG,KAAKhG,CAAxB,EAA4BiG,GAAD,IAAS;YAC9B1G,UAAUkC,EAAV,EAAcwE,IAAIlG,CAAlB,CAAJ,EAA0B;eACnB0B,GAAGyE,OAAH,CAAWD,IAAIlG,CAAf,EAAkBkG,IAAIjG,CAAtB,CAAL;iBACO,KAAP;;eAEK,IAAP;OALF;aAOO,KAAP;;WAEK,IAAP;GAXF;SAaOyB,EAAP;CAdF;;;;;;;AAsBA,MAAMe,SAAUf,EAAD,IAAQ;SACd0E,QAAP,CAAgB9G,OAAhB,CAAyB+G,OAAD,IAAa;QAC/B7G,UAAUkC,EAAV,EAAc2E,QAAQrG,CAAtB,CAAJ,EAA8B;WACvB0B,GAAGyE,OAAH,CAAWE,QAAQrG,CAAnB,EAAsBqG,QAAQpG,CAA9B,CAAL;;GAFJ;;;MAOIyB,GAAG4E,MAAH,CAAU,GAAV,MAAmB,GAAnB,IAA0B5E,GAAG/B,OAAH,CAAW,MAAX,MAAuB,GAArD,EAA0D;WACjD+B,EAAP;;SAEM,IAAGhB,YAAYgB,EAAZ,EAAgBa,OAAOgE,OAAP,IAAkB1E,GAAlC,CAAuC,EAAlD;CAXF;;;;;;;AAmBA,MAAMmC,YAAatC,EAAD,IAAQ;QAClB8E,MAAM5E,cAAcF,EAAd,CAAZ;MACI8E,GAAJ,EAAS;WACAA,GAAP;;gBAEY9E,EAAd,IAAoB,IAAIc,MAAJ,CAAWd,EAAX,CAApB;SACOE,cAAcF,EAAd,CAAP;CANF;;AASA,MAAM+E,mBAAmB,MAAM;MACzBtE,SAASuE,aAAb,EAA4B;WACnBvE,SAASuE,aAAhB;;;MAGE1E,qBAAJ,EAA2B;WAClBA,qBAAP;;;MAGEC,qBAAqBA,kBAAkBsC,UAAlB,KAAiC,aAA1D,EAAyE;WAChEtC,iBAAP;;;QAGI0E,UAAUxE,SAASC,oBAAT,CAA8B,QAA9B,CAAhB;UACQ9C,OAAR,CAAiBkF,MAAD,IAAY;QACtBA,OAAOD,UAAP,KAAsB,aAA1B,EAAyC;0BACnBC,MAApB;;GAFJ;;SAMOvC,iBAAP;CApBF;;;;;;;;;AA8BA,MAAM2E,SAAS,CAAClF,EAAD,EAAKgB,IAAL,EAAWI,OAAX,KAAuB;MAChCJ,SAAS+B,SAAT,IAAsB3B,YAAY2B,SAAtC,EAAiD;;cAErC/C,EAAV;SACK,IAAL;GAHF,MAIO,IAAIoB,YAAY2B,SAAhB,EAA2B;;;cAGtB/B,IAAV;WACO,IAAP;QACIpB,MAAMC,OAAN,CAAcG,EAAd,CAAJ,EAAuB;aACdA,EAAP;WACK,IAAL;;;;MAIAiB,UAAU,IAAd;MACI,CAACrB,MAAMC,OAAN,CAAcmB,IAAd,CAAD,IAAwB,OAAOI,OAAP,KAAmB,UAA/C,EAA2D;WAClD,EAAP;YACQ+D,QAAR,GACGV,OADH,CACW,0CADX,EACuD,EADvD,EAEGA,OAFH,CAEW,gDAFX,EAE6D,CAAC1F,KAAD,EAAQoD,GAAR,KAAgB;WACpE9D,IAAL,CAAU8D,GAAV;KAHJ;cAKU,KAAV;;;MAGE,CAACnC,EAAL,EAAS;UACD8C,SAASiC,kBAAf;SACKjC,UAAUA,OAAOsC,YAAP,CAAoB,gBAApB,CAAf;;;MAGE,CAACpF,EAAL,EAAS;;;;QAIH8E,MAAMxC,UAAUtC,EAAV,CAAZ;MACIA,EAAJ,GAASA,EAAT;MACIgB,IAAJ,GAAWA,QAAQ,EAAnB;MACIC,OAAJ,GAAcA,OAAd;MACIG,OAAJ,GAAcA,OAAd;MACIF,KAAJ,GAAY3D,OAAO0F,OAAnB;CAzCF;AA2CAiC,OAAOG,GAAP,GAAa,EAAb;;;;;;;AAOA,MAAM9D,iBAAiBtC,QAAQ,CAAC+B,IAAD,EAAO2B,QAAP,EAAiBH,OAAjB,KAA6B;MACtD,CAAC5C,MAAMC,OAAN,CAAcmB,IAAd,CAAL,EAA0B;;UAElBhB,KAAK2B,UAAUX,IAAV,EAAgB/B,IAAhB,CAAX;WACOqD,UAAUtC,EAAV,EAAcsF,aAAd,EAAP;;QAEIC,WAAW5D,UAAUf,QAAV,EAAoB3B,IAApB,CAAjB;QACM6F,MAAM,IAAIhE,MAAJ,CAAWyE,QAAX,CAAZ;MACIvE,IAAJ,GAAWA,IAAX;MACII,OAAJ,GAAcuB,YAAYrF,SAA1B;MACIqF,QAAJ,GAAe,MAAM;QACf3B,IAAJ,CAASpD,OAAT,CAAkBuE,GAAD,IAAS;UACpBA,IAAIlE,OAAJ,CAAY,GAAZ,MAAqB,CAAC,CAAtB,IAA2B,CAAC8B,gBAAgBoC,GAAhB,CAAhC,EAAsD;YAChDb,OAAJ,CAAYa,GAAZ;;KAFJ;QAKImD,aAAJ;GANF;MAQIpE,KAAJ,GAAY3D,OAAO0F,OAAnB;MACIT,OAAJ,GAAcA,OAAd;MACIC,UAAJ;SACOqC,GAAP;CArBF;;;AAyBA,MAAMxD,UAAUC,eAAeX,QAAf,CAAhB;AACAU,QAAQT,MAAR,GAAkB1C,GAAD,IAAS;aACb0C,MAAX,EAAmB1C,GAAnB;MACIA,IAAI0G,OAAR,EAAiB;QACX1G,IAAI0G,OAAJ,CAAYD,MAAZ,CAAmB,CAAnB,MAA0B,GAA9B,EAAmC;aAC1BC,OAAP,GAAiB7F,YAAYb,IAAI0G,OAAhB,EAAyB1E,GAAzB,CAAjB;KADF,MAEO;aACE0E,OAAP,GAAiB1G,IAAI0G,OAArB;;;;SAIGX,QAAP,CAAgBtG,OAAhB,CAAwB,CAAC4H,WAAD,EAAcC,GAAd,KAAsB;QACxC,OAAOD,WAAP,KAAuB,QAA3B,EAAqC;YAC7BtG,WAAWsG,YAAYrG,KAAZ,CAAkB,GAAlB,CAAjB;aACO+E,QAAP,CAAgBuB,GAAhB,IAAuB;cACfvG,SAAS,CAAT,CADe;kBAEXsG,WAFW;cAGf;OAHR;;;QAOEA,YAAYnB,IAAhB,EAAsB;kBACRA,IAAZ,GAAmBmB,YAAYnB,IAAZ,CAAiBI,OAAjB,CAAyB,KAAzB,EAAgC,EAAhC,CAAnB;;;QAGEe,YAAYpF,QAAhB,EAA0B;aACjBsF,KAAP,CAAaF,YAAYpB,IAAzB,IAAiCoB,YAAYpF,QAA7C;;GAfJ;;SAmBOkE,OAAP,GAAiBpG,gBAAgB2C,OAAO2D,GAAvB,CAAjB;SACOF,OAAP,CAAe1G,OAAf,CAAwB2G,IAAD,IAAU;SAC1BhG,CAAL,GAASL,gBAAgBqG,KAAKhG,CAArB,CAAT;GADF;;SAIOmG,QAAP,GAAkBxG,gBAAgB2C,OAAO6E,KAAvB,CAAlB;CAlCF;;AAqCA,IAAI,CAACC,OAAOrE,OAAZ,EAAqB;SACZA,OAAP,GAAiBA,OAAjB;SACO4D,MAAP,GAAgBA,MAAhB;SACOhF,aAAP,GAAuBA,aAAvB;;;AAGF,YAAe;eAAA;SAAA;;CAAf;;;;;;;;"}